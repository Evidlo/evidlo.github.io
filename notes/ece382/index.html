<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" type="text/css" href="/fancy.css"/>
  <link rel="stylesheet" type="text/css" href="/notes.css"/>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Evan Widloski</title>
  <style type="text/css">code{white-space: pre;}</style>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-25109327-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  
  
  <script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    displayAlign: "left",
    displayIndent: "0em"
  });
  </script>

  <script>
    function showHide(e) {
    latexblock = $(e).find('.latex');
    if (latexblock.hasClass('opened')) {
        // close block
        latexblock.removeClass('opened');
        latexblock.hide();
    } else {
        // open block
        latexblock.addClass('opened');
        latexblock.show();
    }
  }
  </script>

  </head>

<body>
	<div class="v h">
		<div class="h hc">
			<div class="simplebox">
				<div class="title">ECE382 - Control Systems - Spring 2016</div>
				<div class="body v">
                    <ul>
          <li><a href="#block-diagrams">Block diagrams</a></li>
          <li><a href="#generalized-feedback-system">Generalized Feedback System</a><ul>
          <li><a href="#signal-flow-graph">Signal flow graph</a></li>
          <li><a href="#masons-gain-formula">Mason's Gain Formula</a></li>
          </ul></li>
          <li><a href="#poles-and-zeros">Poles and Zeros</a><ul>
          <li><a href="#open-loop">Open loop</a></li>
          <li><a href="#closed-loop">Closed loop</a></li>
          </ul></li>
          <li><a href="#characteristic-equation">Characteristic Equation</a></li>
          <li><a href="#second-order-systems">Second-order systems</a><ul>
          <li><a href="#characterization">Characterization</a></li>
          </ul></li>
          <li><a href="#routh-hurwitz-stability-test">Routh-Hurwitz Stability Test</a></li>
          <li><a href="#root-locus">Root Locus</a><ul>
          <li><a href="#finding-closed-loop-poles">Finding closed loop poles</a></li>
          <li><a href="#constructing-root-locus">Constructing root locus</a></li>
          <li><a href="#root-locus-in-octave">Root locus in Octave</a></li>
          </ul></li>
          <li><a href="#compensators">Compensators</a><ul>
          <li><a href="#selecting-a-compensator">Selecting a Compensator</a></li>
          <li><a href="#before-designing-a-compensator-for-time-specifications">Before designing a compensator (for time specifications)</a></li>
          <li><a href="#lead-compensator">Lead compensator</a></li>
          <li><a href="#proportional-derivative-pd">Proportional-derivative (PD)</a></li>
          <li><a href="#lag-compensator">Lag compensator</a></li>
          <li><a href="#lag-lead-compensator">Lag-lead compensator</a></li>
          <li><a href="#proportional-integral-pi">Proportional-integral (PI)â€¦</a></li>
          <li><a href="#proportional-integral-derivative-pid">Proportional-integral-derivative (PID)</a></li>
          <li><a href="#phase-lead">Phase-lead</a></li>
          </ul></li>
          <li><a href="#matlab-siso-toolbox">MATLAB SISO Toolbox</a></li>
          <li><a href="#bode-plots">Bode Plots</a><ul>
          <li><a href="#constant">Constant</a></li>
          <li><a href="#zero-at-origin">Zero at origin</a></li>
          <li><a href="#pole-at-origin">Pole at origin</a></li>
          <li><a href="#zero">Zero</a></li>
          <li><a href="#pole">Pole</a></li>
          <li><a href="#complex">Complex</a></li>
          <li><a href="#construction-by-hand">Construction by Hand</a></li>
          </ul></li>
          <li><a href="#nyquist-plots">Nyquist Plots</a><ul>
          <li><a href="#cauchy-theorem">Cauchy Theorem</a></li>
          <li><a href="#nyquist-stability-criterion">Nyquist Stability Criterion</a></li>
          <li><a href="#construction">Construction</a></li>
          <li><a href="#gain-and-phase-margins">Gain and Phase Margins</a></li>
          </ul></li>
          <li><a href="#lead-compensator-design-in-frequency-domain">Lead Compensator Design in Frequency Domain</a><ul>
          <li><a href="#design-summary">Design Summary</a></li>
          </ul></li>
          </ul>
                    <h1 id="block-diagrams">Block diagrams</h1>
<p><a href="./blockdiagram.png"><img src="./blockdiagram.png" /></a></p>
<div class="definition">
<p><strong>a</strong> - pickoff point</p>
<p><strong>b</strong> - block</p>
<p><strong>c</strong> - arrow</p>
<p><strong>d</strong> - summing junction</p>
</div>
<h1 id="generalized-feedback-system">Generalized Feedback System</h1>
<div class="definition">
<p><strong>closed loop gain</strong> - <span class="math inline">\(T(s) = \frac{C(s)}{R(s)}\)</span></p>
<p><strong>open loop gain</strong> - <span class="math inline">\(\frac{B(s)}{E(s)}\)</span></p>
<p><strong>feedforward gain</strong> - <span class="math inline">\(\frac{C(s)}{E(s)}\)</span></p>
</div>
<div class="examples">
<ol>
<li><p>Express the circuit as a block diagram</p>
<p><a href="./circuit.png"><img src="./circuit.png" /></a></p>
<p><span class="math display">\[\frac{V_{in} - V_{out}}{R} = i\]</span></p>
<p><span class="math inline">\(V_{out} = \frac{1}{C} \int i(t) dt = \frac{1}{sC} i\)</span></p>
<p><a href="./circuitblock.png"><img src="./circuitblock.png" /></a></p></li>
</ol>
</div>
<h2 id="signal-flow-graph">Signal flow graph</h2>
<p><a href="./signalflow.png"><img src="./signalflow.png" /></a></p>
<div class="definition">
<p><strong>node</strong> - signal or variable</p>
<p><strong>transmittance</strong> - gain between nodes</p>
<p><strong>path</strong> - traversal of nodes</p>
<p><strong>loop</strong> - closed path</p>
<p><strong>forward path gain</strong> - gain of open path</p>
</div>
<h2 id="masons-gain-formula">Mason's Gain Formula</h2>
<p>Used to calculate gain between nodes in complex graphs</p>
<div class="definition">
<p><strong>Mason's gain formula</strong></p>
<p><span class="math display">\[G_{BA} = \frac{\sum P_i \Delta_i}{\Delta}\]</span></p>
<p>Graph cofactor <span class="math display">\[\Delta = 1 - \sum \text{1-loop gains} + \sum \text{2-loop gains} - ...\]</span></p>
<p>Where <span class="math inline">\(\text{n-loop gains}\)</span> are the loop gains of all permutations of non-touching 1-loops</p>
<p><span class="math inline">\(P_i\)</span> - ith forward path gain</p>
<p><span class="math inline">\(\Delta_i\)</span> - graph cofactor with the gains of loops touching the ith forward path removed</p>
</div>
<div class="examples">
<ol>
<li><p>Find the gain between <span class="math inline">\(x1\)</span> and <span class="math inline">\(r1\)</span> where</p>
<p><span class="math inline">\(A_{11} x_1 + A_{12} x_2 + r_1 = x_1\)</span></p>
<p><span class="math inline">\(A_{21} x_1 + A_{22} x_2 + r_2 = x_2\)</span></p>
<p><a href="./masonsexample.png"><img src="./masonsexample.png" /></a></p>
<strong>1-loops</strong>
<ul>
<li><span class="math inline">\(L_1 = A_{11}\)</span></li>
<li><span class="math inline">\(L_2 = A_{12} A_{21}\)</span></li>
<li><span class="math inline">\(L_3 = A_{22}\)</span></li>
</ul>
<strong>2-loops</strong>
<ul>
<li><span class="math inline">\(L_1L_2 = A_{11}A_{22}\)</span></li>
</ul>
<p><span class="math inline">\(\Delta = 1 - L_1 - L_2 - L_3 + L_1L_2 = 1 - A_{11} - A_{12} A_{21} - A_{22} + A_{11}A_{22}\)</span></p>
<p><span class="math display">\[\frac{x_1}{r_1} = \frac{P_1 \Delta_1}{\Delta} = \frac{(1)(1 - L_2)}{\Delta} = \frac{1 - A_{22}}{1 - A_{11} - A_{12} A_{21} - A_{22} + A_{11}A_{22}}\]</span></p></li>
</ol>
</div>
<h1 id="poles-and-zeros">Poles and Zeros</h1>
<h2 id="open-loop">Open loop</h2>
<h2 id="closed-loop">Closed loop</h2>
<p><a href="./loop.png"><img src="./loop.png" /></a></p>
<p>roots of <span class="math inline">\(G(s)\)</span>: closed loop zeros</p>
<p>roots of <span class="math inline">\(1 + G(s)\)</span>: closed loop poles</p>
<p><span class="math inline">\(\frac{B}{E} = G(s)H(s)\)</span></p>
<p>roots of <span class="math inline">\(G(s)H(s)\)</span>: zeros</p>
<p>poles of <span class="math inline">\(G(s)H(s)\)</span>: poles</p>
<h1 id="characteristic-equation">Characteristic Equation</h1>
<div class="definition">
<p>Characteristic equation - <span class="math inline">\(1 + G(s)H(s) = 1 + \frac{N_1N_2}{D_1D_2} = \frac{D_1D_2 + N_1N_2}{D_1D_2}\)</span></p>
</div>
<p><span class="math inline">\(D_1D_2 + N_1N_2\)</span>: closed-loop poles</p>
<p><span class="math inline">\(D_1D_2\)</span>: open-loop poles</p>
<p>transfer functions needs to be in polynomial form</p>
<div class="examples">
<ol>
<li><p><span class="math inline">\(G_2(s) = \frac{1}{s-1}\)</span></p>
<p><span class="math inline">\(s = +1 \Rightarrow e^t\)</span>, so system is unstable</p></li>
</ol>
</div>
<h1 id="second-order-systems">Second-order systems</h1>
<h2 id="characterization">Characterization</h2>
<p><strong>second-order transfer function</strong> - <span class="math display">\[T(s) = \frac{N}{N + D} = \frac{w_n^2}{s^2 + 2\zeta w_ns + w_n^2}\]</span></p>
<p><span class="math inline">\(\zeta = \cos (\theta)\)</span>: damping coefficient</p>
<p><span class="math inline">\(w_n\)</span>: undamped natural frequency</p>
<p><span class="math inline">\(w_d = w_n \sqrt{1 - \zeta^2}\)</span> - damped frequency</p>
<p><span class="math inline">\(\zeta \omega_n\)</span>: attenuation</p>
<p>use quadratic formula to find poles</p>
<span class="math display">\[\begin{equation*}
s_1,s_2 =
  \begin{cases}
    -\zeta w_n +- w_n \sqrt{\zeta^2 -1} &amp; \zeta \geq 0 \\ 
    -\zeta w_n +- w_n \sqrt{1 - \zeta^2} &amp; 0 &lt; \zeta &lt; 1
  \end{cases}
\end{equation*}
\]</span>
<p><a href="./damping.png"><img src="./damping.png" /></a></p>
<p>Four cases:</p>
<ol>
<li><span class="math inline">\(\zeta = 0\)</span>: infinite signal</li>
<li><span class="math inline">\(\zeta = 1\)</span>: critically-damped$</li>
<li><span class="math inline">\(0 &lt; \zeta &lt; 1\)</span> - infinite oscillations</li>
<li><span class="math inline">\(\zeta &gt; 1\)</span> - overdamped</li>
</ol>
<h1 id="routh-hurwitz-stability-test">Routh-Hurwitz Stability Test</h1>
<ol>
<li>Construct first two rows</li>
<li>Construct next rows based on first two</li>
<li>Count number of sign changes in first column to find RHP poles</li>
</ol>
<p>Let <span class="math inline">\(Q(s) = a_ns^n + a_{n-1}s^{n-1} + ... + a_1s + a_0 = 0\)</span></p>
<p>If <span class="math inline">\(n\)</span> is even</p>
<table>
<tbody>
<tr class="odd">
<td><span class="math inline">\(s^n\)</span></td>
<td><span class="math inline">\(a_n\)</span></td>
<td><span class="math inline">\(a_{n-2}\)</span></td>
<td>â€¦</td>
<td><span class="math inline">\(a_0\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(s^{n-1}\)</span></td>
<td><span class="math inline">\(a_{n-1}\)</span></td>
<td><span class="math inline">\(a_{n-3}\)</span></td>
<td>â€¦</td>
<td><span class="math inline">\(a_1\)</span></td>
</tr>
</tbody>
</table>
<p>If <span class="math inline">\(n\)</span> is odd</p>
<table>
<tbody>
<tr class="odd">
<td><span class="math inline">\(s^n\)</span></td>
<td><span class="math inline">\(a_n\)</span></td>
<td><span class="math inline">\(a_{n-2}\)</span></td>
<td>â€¦</td>
<td><span class="math inline">\(a_0\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(s^{n-1}\)</span></td>
<td><span class="math inline">\(a_{n-1}\)</span></td>
<td><span class="math inline">\(a_{n-3}\)</span></td>
<td>â€¦</td>
<td><span class="math inline">\(a_1\)</span></td>
</tr>
</tbody>
</table>
<p>Construct rest of table</p>
<table>
<tbody>
<tr class="odd">
<td><span class="math inline">\(s^{n-2}\)</span></td>
<td><span class="math inline">\(b_1\)</span></td>
<td><span class="math inline">\(b_2\)</span></td>
<td>â€¦</td>
<td><span class="math inline">\(b_{n+1}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(s^{n-3}\)</span></td>
<td><span class="math inline">\(c_1\)</span></td>
<td><span class="math inline">\(c_2\)</span></td>
<td>â€¦</td>
<td><span class="math inline">\(c_{n+1}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(s^{n-4}\)</span></td>
<td><span class="math inline">\(d_1\)</span></td>
<td><span class="math inline">\(d_2\)</span></td>
<td>â€¦</td>
<td><span class="math inline">\(d_{n+1}\)</span></td>
</tr>
</tbody>
</table>
<p>Where <span class="math display">\[ \begin{aligned}
b_1 &amp; = \frac{a_{n_1}a_{n-2} - a_na_{n-3}}{a_{n-1}} \\
b_2 &amp; = \frac{a_{n_1}a_{n-2} - a_na_{n-4}}{a_{n-2}} \\
...
\end{aligned} \]</span></p>
<p>If <span class="math inline">\(b_n\)</span> is zero, use <span class="math inline">\(\varepsilon\)</span> as a placeholder for a positive number. Assume blank entries to be 0.</p>
<p>If a row is zero, differentiate the row above it and replace the zeros with the coefficients.</p>
<p>The number of sign changes in the first column is equal to the number of poles in RHP.</p>
<p>If the rows above and below <span class="math inline">\(\varepsilon\)</span> have the same sign, then the poles are on the imaginary axis.</p>
<p>If the rows above and below <span class="math inline">\(\varepsilon\)</span> have the same sign, then the poles are on the real axis.</p>
<div class="examples">
<ol>
<li><p>Let <span class="math inline">\(Q(s) = s(s+1)(s+2) + 7 = s^3 + 3s^2 + 2s + 7 = 0\)</span></p>
<table>
<tbody>
<tr class="odd">
<td><span class="math inline">\(s^3\)</span></td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td><span class="math inline">\(s^2\)</span></td>
<td>3</td>
<td>7</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(s\)</span></td>
<td><span class="math inline">\(\frac{-1}{3}\)</span></td>
<td>nan</td>
</tr>
<tr class="even">
<td><span class="math inline">\(s^0\)</span></td>
<td>7</td>
<td>nan</td>
</tr>
</tbody>
</table>
<p>Two sign changes means two RHP poles, 1 LHP pole, so the system is unstable.</p></li>
<li><p>Let <span class="math inline">\(Q(s) = s^3 + 4s^2 + s - 6\)</span></p>
<table>
<tbody>
<tr class="odd">
<td><span class="math inline">\(s^3\)</span></td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td><span class="math inline">\(s^2\)</span></td>
<td>4</td>
<td>-6</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(s^1\)</span></td>
<td><span class="math inline">\(\frac{10}{4}\)</span></td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">\(s^0\)</span></td>
<td>-6</td>
<td></td>
</tr>
</tbody>
</table>
<p>One sign change means one RHP pole, 2 LHP poles, so the system is unstable.</p></li>
<li><p>Let <span class="math inline">\(Q(s) = s^3 - s^2 - s + 1 = 0\)</span></p>
<table>
<tbody>
<tr class="odd">
<td><span class="math inline">\(s^3\)</span></td>
<td>1</td>
<td>-1</td>
</tr>
<tr class="even">
<td><span class="math inline">\(s^2\)</span></td>
<td>-1</td>
<td>1</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(s^1\)</span></td>
<td><span class="math inline">\(\varepsilon\)</span></td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">\(s^0\)</span></td>
<td>1</td>
<td></td>
</tr>
</tbody>
</table></li>
</ol>
</div>
<div class="examples">
<ol>
<li><p><span class="math inline">\(G(s) = \frac{k}{s(s+1)(s+2)}\)</span> <span class="math inline">\(k_p = \lim_{s \to 0} G(s) = \infty\)</span> <span class="math inline">\(k_v = \lim_{s \to 0} s G(s) = \frac{k}{2}\)</span> <span class="math inline">\(e_{ss} = \frac{3}{1 + k_p} + \frac{2}{k_v} = \frac{4}{k}\)</span> <span class="math inline">\(Q(s) = s(s+1)(s+2) + K = s^3 + 3s^2 + 2s + K\)</span></p>
<table>
<tbody>
<tr class="odd">
<td><span class="math inline">\(s^3\)</span></td>
<td><span class="math inline">\(1\)</span></td>
<td><span class="math inline">\(2\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(s^2\)</span></td>
<td><span class="math inline">\(3\)</span></td>
<td><span class="math inline">\(K\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(s^1\)</span></td>
<td><span class="math inline">\(\frac{6-K}{3}\)</span></td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">\(s^0\)</span></td>
<td><span class="math inline">\(0\)</span></td>
<td></td>
</tr>
</tbody>
</table></li>
<li><p><span class="math inline">\(T(s) = \frac{G}{1+G} = \frac{k}{s^2 +2s + K}\)</span></p>
<p><span class="math inline">\(Q(s) = \frac{s^2 + 2s + K}{s(s+2)}\)</span></p>
<p><span class="math inline">\(Q(s) = s^2 + 2s + K\)</span></p>
<table>
<tbody>
<tr class="odd">
<td><span class="math inline">\(s^2\)</span></td>
<td>1</td>
<td>K</td>
</tr>
<tr class="even">
<td><span class="math inline">\(s^1\)</span></td>
<td><span class="math inline">\(2\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(s^0\)</span></td>
<td><span class="math inline">\(2K\)</span></td>
<td></td>
</tr>
</tbody>
</table>
<p>System is stable for all <span class="math inline">\(K &gt; 0\)</span></p>
<p><span class="math inline">\(s_1,s_2 = \frac{-2 +- \sqrt{4 - 4K}}{2} = -1 += \sqrt{1-K}\)</span></p>
<p>Let <span class="math inline">\(K=0\)</span>, then <span class="math inline">\(s_1,s_2 = 0, -2\)</span></p>
<p>Let <span class="math inline">\(K=.5\)</span>, then <span class="math inline">\(s_1,s_2 = -0.29, -1.707\)</span></p>
<p>Overdamped</p>
<p>Let <span class="math inline">\(K=1\)</span>, then <span class="math inline">\(s_1,s_2 = -1, 1\)</span></p>
<p>Critically damped</p>
<p>Let <span class="math inline">\(K=2\)</span>, then <span class="math inline">\(s_1,s_2 = -1+j, 1+j\)</span></p>
<p>Underdamped</p>
<p><a href="./root_locus.png"><img src="./root_locus.png" /></a></p></li>
</ol>
</div>
<h1 id="root-locus">Root Locus</h1>
<p>Let <span class="math inline">\(F(s)\)</span> be some complex function and <span class="math inline">\(s_1\)</span> be some complex point.</p>
<p>Then <span class="math display">\[|F(s)| = \frac{|s_1 + z_1|...|s_1 + z_n|}{|s_1 + p_1|...|s_1 + p_n|}\]</span></p>
<p>and <span class="math display">\[\angle F(s) = \sum \angle (zeros \rightarrow s_1) - \sum \angle (poles \rightarrow s_1)\]</span></p>
<h2 id="finding-closed-loop-poles">Finding closed loop poles</h2>
<p>With the characteristic equation, we can find all the poles of the closed-loop transfer function and determine stability.</p>
<p>The zeroes of the characteristic equation are the poles of the closed-loop transfer function.</p>
<p>Note that we factor <span class="math inline">\(K\)</span> out of <span class="math inline">\(G(s)H(s)\)</span> since the gain is trivial to adjust in most systems.</p>
<p><span class="math display">\[Q(s) = 1 + KG(s)H(s) = 1 + \frac{K (s + Z_1) ... (s + Z_n)}{(s + P_1) ... (s + P_n)}\]</span></p>
<p><span class="math display">\[KG(s)H(s) = \frac{K (s + Z_1) ... (s + Z_n)}{(s + P_1) ... (s + P_n)} = -1 + j0\]</span></p>
<p>So <span class="math display">\[\frac{K |s + Z_1| ... |s + Z_n|}{|s + P_1| ... |s + P_n|} = 1\]</span></p>
<p>and <span class="math display">\[\sum \angle (zeros \rightarrow s_1) - \sum \angle (poles \rightarrow s_1) = \pi(1 + 2n), n = 0,1,2,...\]</span></p>
<p>When testing specific points, it is generally easier to start by checking the angle first.</p>
<div class="examples">
<ol>
<li><p>Given <span class="math inline">\(G(s)H(s) = \frac{s+1}{s+3}\)</span>, check if <span class="math inline">\(s_1 = 2 + j3\)</span> is located on the root locus</p>
<p><a href="./rootlocus1.png"><img src="./rootlocus1.png" /></a></p>
<p><span class="math inline">\(\theta_1 - \phi_1 = \tan^{-1} (\frac{3}{3}) - \tan^{-1} (\frac{3}{5}) \approx 14^{\circ}\)</span></p>
<p>Characteristic equation: <span class="math inline">\(1 + KG(s)H(s) = 0\)</span></p>
<p>So <span class="math inline">\(s_1\)</span> is not part of the root locus</p></li>
</ol>
</div>
<h2 id="constructing-root-locus">Constructing root locus</h2>
<p>Rules</p>
<ol>
<li>root locus has 1 branch for every pole of the characteristic equation (zero of closed loop)</li>
<li>branches start at poles and ends at zeros</li>
<li>root locus is defined for areas on the real axis where the number of poles and zeros to the right is odd</li>
<li>the asymptotes of the zeros at infinity have the angle <span class="math display">\[\phi_i = \frac{180^\circ (1 + 2 n)}{N_p - N_z}, n = 0, 1, 2, ..., (N_p - N_z -1)\]</span> where <span class="math inline">\(N_p,N_z\)</span> are number of poles, zeros</li>
<li>centroid: <span class="math inline">\(\sigma_A = \frac{\sum Re(p_i) - \sum Re(z_i)}{N_p - N_z}\)</span></li>
<li><p>branches intersect the real axis where K is at a local min/max (<span class="math inline">\(\frac{d G(s) H(s)}{ds} = 0\)</span>) (breakaway/breakin point)</p>

<div class="derivation" onclick="showHide(this);">
<div>
Derivation
</div>
<div class="derivation latex" style="display:none;">

<p><span class="math inline">\(1 + KG(s)H(s) = 0\)</span> <span class="math inline">\(\frac{dK}{ds} = \frac{d}{ds} \frac{-1}{G(s)H(s)} = \frac{d}{ds} G(s)H(s)\)</span></p>

</div>
</div>
</li>
<li><p>angle of departure from a pole: <span class="math inline">\(\phi_p = \sum \angle (zeros \rightarrow s_1) - \sum \angle (poles \rightarrow s_1) - \pi\)</span></p>

<div class="derivation" onclick="showHide(this);">
<div>
Derivation
</div>
<div class="derivation latex" style="display:none;">

<p><span class="math display">\[\angle G(s)H(s)|_{s=s_1} = \sum \angle (zeros \rightarrow s_1) - \sum \angle (poles (except s_1) \rightarrow s_1) - \phi_p = \pi\]</span></p>
<p><span class="math inline">\(\phi_p = \sum \angle (zeros \rightarrow s_1) - \sum \angle (poles \rightarrow s_1) - \pi\)</span></p>

</div>
</div>
</li>
<li><p>Routh-Hurwitz</p></li>
</ol>
<div class="examples">
<ol>
<li><p>Let <span class="math inline">\(G(s)H(s) = \frac{K}{s (s + 1) (s + 2)}\)</span></p>
<p><span class="math inline">\(N_p = 3, N_z = 0\)</span></p>
<p>From rule 3, the locus is defined on the real axis for <span class="math inline">\((-\infty, -2) \cup (-1, 0)\)</span></p>
<p>From rule 5, The <strong>centroid</strong> is located at <span class="math inline">\(\sigma_A = \frac{\sum Re(p_i) - \sum Re(z_i)}{N_p - N_z} = \frac{-1 + 2 + 0}{3} = -1\)</span></p>
<p>From rule 4, the <strong>asymptotes</strong> of the branches at <span class="math inline">\(K = \infty\)</span> from the centroid are <span class="math inline">\(\phi_i = \frac{180^\circ (1 + 2 n)}{N_p - N_i}, (n = 0,1,2) = 60^\circ, 180^\circ, 300^\circ\)</span></p>
<p><strong>Breakaway point</strong>: <span class="math inline">\(1 + KG(s)H(s) = 0 \rightarrow K = \frac{-1}{G(s)H(s)}\)</span></p>
<p><span class="math display">\[\frac{d}{ds} \frac{1}{s (s + 1) (s + 2)} = \frac{-(1) (3s^2 + 6s + 2)}{[s (s + 1) (s + 2)]^2} = 0\]</span></p>
<p>so <span class="math inline">\(s_1,s_2 = \frac{-6 \pm \sqrt{36 - 24}}{6} \approx -0.42, -1.58\)</span></p>
<p>but <span class="math inline">\(-1.58\)</span> is not defined on the real axis, so it is thrown away</p>
<p><strong>Imaginary axis intersection</strong></p>
<table>
<tbody>
<tr class="odd">
<td><span class="math inline">\(s^3\)</span></td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td><span class="math inline">\(s^2\)</span></td>
<td>3</td>
<td><span class="math inline">\(K\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(s^1\)</span></td>
<td><span class="math inline">\(\frac{6-K}{3}\)</span></td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">\(s^0\)</span></td>
<td>K</td>
<td></td>
</tr>
</tbody>
</table>
<p>So the poles are on the imaginary exis when <span class="math inline">\(K=6\)</span> <a href="./rootlocus_example.png"><img src="./rootlocus_example.png" /></a></p></li>
<li><p>Let <span class="math inline">\(G(s) = \frac{K}{s(s+1)}\)</span></p>
<p><span class="math inline">\(\sigma_A = \frac{\sum Re(p_i) - \sum Re(z_i)}{N_p - N_z} = \frac{-1}{2}\)</span></p>
<p><strong>Breakaway point</strong></p>
<p><span class="math display">\[\frac{d}{ds} [G(s)] = 0\]</span></p>
<p><span class="math inline">\(s = \frac{-1}{2}\)</span></p>
<p><a href="./rootlocus_example2.png"><img src="./rootlocus_example2.png" /></a></p></li>
<li><p>Let <span class="math inline">\(G(s) = \frac{k(s^2 + 2s + 2)}{s(s-2)}\)</span></p>
<p>Zeros are located at <span class="math inline">\(s_1,s_2 = \frac{-2 \pm \sqrt{4 - 8}}{2} = -1 \pm j\)</span></p>
<p><span class="math inline">\(N_p,N_z = 2\)</span>, so no asymptotes</p>
<p><strong>Breakaway point</strong></p>
<p><span class="math display">\[\frac{dK}{ds} = \frac{d}{ds} G(s) = \frac{(s^2 - 2s)(2s + 2) - (s^2 + 2s+ 2)(2s - 2)}{(s(s - 2))^2} =  0\]</span></p>
<p>so <span class="math inline">\(s_1,s_2 = 0.618, -1.68\)</span></p>
<p>but <span class="math inline">\(0.618\)</span> is not defined on the real axis, so it is thrown away</p>
<p><strong>Angle of arrival</strong></p>
<p><span class="math inline">\(\phi_z = \pi + \sum \angle \text{poles} - \sum \angle \text{zeros} = \pi + (\pi - \tan^{-1}\frac{1}{3}) + (\pi - \tan^{-1}\frac{1}{1}) - \frac{\pi}{2} = 26.57^{\circ}\)</span></p>
<p><strong>Imaginary Axis Intersection</strong></p>
<table>
<tbody>
<tr class="odd">
<td><span class="math inline">\(s^2\)</span></td>
<td><span class="math inline">\(1 + K\)</span></td>
<td>$2K</td>
</tr>
<tr class="even">
<td><span class="math inline">\(s^1\)</span></td>
<td><span class="math inline">\(2K-2\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(s^0\)</span></td>
<td><span class="math inline">\(2K\)</span></td>
<td></td>
</tr>
</tbody>
</table>
<p>So no sign change occurs when <span class="math inline">\(K \geq 1\)</span></p>
<p><a href="./rootlocus_example3.png"><img src="./rootlocus_example3.png" /></a></p></li>
<li><p>If <span class="math inline">\(K = 4\)</span>, plot RL for <span class="math inline">\(P &gt; 0\)</span></p>
<p><span class="math inline">\(Q(s) = 1 + G(s) = 1 + \frac{4}{s(s+p)} = s^2 + ps + 4 = 1 + \frac{ps}{s^2 + 4} = 0\)</span></p>
<p><span class="math inline">\(G_1(s) = \frac{ps}{s^2 + 4}\)</span></p>
<p><strong>Angle of departure</strong></p>
<p><span class="math inline">\(\phi_p = \pi + \sum \angle \text{zeros} - \sum \angle \text{poles} = \pi\)</span></p>
<p><strong>Break in point</strong></p>
<p><span class="math display">\[\frac{dp}{ds} = \frac{d}{ds}(\frac{s}{s^2 + 4}) = \frac{(s^2 +4)(1) - s(2s)}{(s^2 + 4)^2} = 0\]</span></p>
<p><span class="math inline">\(s^2 + 4 - 2s^2 = 0\)</span></p>
<p><span class="math inline">\(s_1,s_2 = \pm 2\)</span></p></li>
</ol>
</div>
<h2 id="root-locus-in-octave">Root locus in Octave</h2>
<h1 id="compensators">Compensators</h1>
<div class="definition">
<p><strong>Compensator</strong></p>
<p>A block added in front of the plant of a feedback system to tweak performance, denoted by <span class="math inline">\(G_C(s)\)</span>.</p>
<p><a href="./compensator_fig.png"><img src="./compensator_fig.png" /></a></p>
</div>
<h2 id="selecting-a-compensator">Selecting a Compensator</h2>
<p>Three cases:</p>
<table>
<tbody>
<tr class="odd">
<td>poor transient response</td>
<td>use Lead or PD compensator</td>
</tr>
<tr class="even">
<td>poor steady state error</td>
<td>use Lag or PI compensator</td>
</tr>
<tr class="odd">
<td>poor transient + steady state</td>
<td>use Lag-Lead or PID compensator</td>
</tr>
<tr class="even">
<td>unstable system</td>
<td>use PID compensator</td>
</tr>
</tbody>
</table>
<h2 id="before-designing-a-compensator-for-time-specifications">Before designing a compensator (for time specifications)</h2>
<ul>
<li>Find the desired dominant poles using <span class="math inline">\(\zeta\)</span> and <span class="math inline">\(\omega_n\)</span>. <span class="math inline">\(s^2 + 2\zeta \omega_n s + \omega_n^2  = 0\longrightarrow s_1,s_2 = - \zeta \omega_n \pm \omega_n j \sqrt{1 - \zeta^2}\)</span></li>
<li>Check the angle of deficiency <span class="math inline">\(\phi\)</span> of <span class="math inline">\(\angle G(s_1)\)</span>. If the deficiency is 0, a compensator is not needed and the gain of <span class="math inline">\(G\)</span> can be adjusted.</li>
</ul>
<h2 id="lead-compensator">Lead compensator</h2>
<p>Steps to design a lead compensator:</p>
<ol>
<li>From the angle of deficiency, use the bisector method to determine the pole and zero location.</li>
</ol>
<h2 id="proportional-derivative-pd">Proportional-derivative (PD)</h2>
<p><span class="math inline">\(G_C(s) = K_C(s + z_0)\)</span></p>
<p>Think of PD as a special case of Lead compensator with pole at infinity</p>
<p>Where</p>
<ul>
<li><span class="math inline">\(K_P\)</span> - proportion error constant</li>
<li><span class="math inline">\(K_D\)</span> - proportion error constant</li>
</ul>
<p>Steps to design a PD compensator:</p>
<ol>
<li></li>
</ol>
<h2 id="lag-compensator">Lag compensator</h2>
<p><span class="math display">\[G_C = \frac{K_C(s + \tau)}{s + \frac{\tau}{\alpha}}\]</span></p>
<ul>
<li>Improves steady state error</li>
<li>Places poles close to the imaginary axis</li>
<li>Increases open-loop gain at low frequences</li>
</ul>
<p>Steps to design a lag compensator:</p>
<ol>
<li>Place the zero about 10% of the distance between the origin and the first pole or zero (10% rule).</li>
<li>Find <span class="math inline">\(\alpha\)</span> with steady state specifications. Assume <span class="math inline">\(K_C \approx 1\)</span> (e.g <span class="math inline">\(K_V = \lim_{s \to 0} sG_C{s}{G}\)</span>)</li>
<li>Increase <span class="math inline">\(\alpha\)</span> by about 10% for a margin of safety and place the pole.</li>
<li>Determine if the angle contributed by the compensator is too much and if the 5% rule should be used instead.</li>
<li>Use the magnitude condition to find <span class="math inline">\(K_C\)</span>. (<span class="math inline">\(|G_C(s)G(s)| = 1\)</span>)</li>
<li>Evaluate steady state of <span class="math inline">\(G_C(s)G(s)\)</span> to determine if it meets the design criteria.</li>
</ol>
<div class="examples">
<ol>
<li><p>Let <span class="math inline">\(G(s) = \frac{4}{s(s+2)}\)</span></p>
<p><span class="math inline">\(T(s) = \frac{4}{s^2 + 2s + 4}\)</span></p>
<p><span class="math inline">\(s_1,s_2 = -1 \pm j \sqrt{3}\)</span></p>
<p>This yields <span class="math inline">\(k_V^G = \lim_{s \to 0} sG(s) = 2\)</span></p>
<p>Assume design objective <span class="math inline">\(K_V = 20\)</span></p>
<p><span class="math display">\[ \begin{aligned}
  \lim_{s \to 0}sG_C(s)G(s) &amp; = \frac{4K_C(s + \tau)}{(s + \tau/\alpha)(s + 2)} \\
  &amp; = 2K_C\alpha = 20
  \end{aligned} \]</span></p>
<p>Let <span class="math inline">\(K_C = 1\)</span>. Then <span class="math inline">\(\alpha = 10 \longrightarrow \alpha = 11\)</span></p>
<p>With the 10% rule, we place the zero at <span class="math inline">\(-.2\)</span> and the pole at <span class="math inline">\(-.2/11\)</span>.</p>
<p>The angle added by the compensator is: <span class="math inline">\(\phi  =  \left(\pi - tan^{-1}\left( \frac{\sqrt{3}}{.8} \right) \right) - \left(\pi - tan^{-1}\left( \frac{\sqrt{3}}{1 - .2/11} \right) \right) = -4.75^{\circ}\)</span></p>
<p><strong>IPE plot</strong></p>
<p>Finally, using the magnitude condition to find <span class="math inline">\(K_C\)</span>,</p>
<p><span class="math inline">\(|G_C(s)G(s)| = \frac{4K_C\sqrt{.8^2 + 3}}{\sqrt{(-1 + .2/11)^2 + 3} + 3} * \frac{1}{\sqrt{1 + 3} \sqrt{1 + 3}} = 1\)</span></p>
<p>so <span class="math inline">\(K_C = 1.044\)</span>, and finally</p>
<p><span class="math display">\[G_C(s) = \frac{1.044(s + .2)}{s + .2/11}\]</span></p></li>
</ol>
</div>
<h2 id="lag-lead-compensator">Lag-lead compensator</h2>
<p><span class="math display">\[G_C(s) = \left[\frac{K_c(s + \frac{1}{\tau})}{s + \frac{1}{\alpha_1 \tau_1}} \right] \left[ \frac{s + \frac{1}{\tau_2}}{s + \frac{1}{\alpha_2 \tau_2}} \right]\]</span></p>
<ol>
<li>Find the angle of deficiency (including the pole-zero pair close to the origin)</li>
</ol>
<div class="examples">
<ol>
<li></li>
</ol>
</div>
<h2 id="proportional-integral-pi">Proportional-integral (PI)â€¦</h2>
<p>Similar to Lag compensator, but pole added is on the origin. This means the type number is one more than an equivalent Lag compensator</p>
<h2 id="proportional-integral-derivative-pid">Proportional-integral-derivative (PID)</h2>
<p><span class="math display">\[ G_C(s) = (K_P + K_D s + \frac{K_I}{s})\]</span></p>
<div class="examples">
<ol>
<li></li>
</ol>
</div>
<h2 id="phase-lead">Phase-lead</h2>
<div class="examples">
<ol>
<li><p>Let <span class="math inline">\(G(s) = \frac{4}{s(s+2)}\)</span></p>
<p><span class="math inline">\(T(s) = \frac{4}{s^2 + 2s + 4}\)</span></p>
<p><span class="math inline">\(s_1,s_2 = -1 \pm j\sqrt(3) = - \zeta \omega_n \pm j \omega_n \sqrt{1 - \zeta^2}\)</span> so <span class="math inline">\(\zeta = 0.5, w_n = 2\)</span></p>
<p>Suppose we want <span class="math inline">\(\zeta = 0.5, w_n = 4\)</span> (same overshoot, but faster settling time)</p>
<p><span class="math inline">\(s_1^*,s_2^* = -2 \pm 2j \sqrt{3}\)</span></p>
<p>So we want <span class="math inline">\(s_1^*\)</span> to be part of the root locus:</p>
<p><span class="math display">\[ \begin{aligned}
  \angle G_d(s_1^*) &amp; = \angle G_C(s_1^*) + \angle G(s_1^*) = \pi \\
  &amp; = \phi + [ -\theta_1 -\theta_2 ] = \pi \\
  &amp; = \phi - \frac{\pi}{6} = \pi
  \end{aligned} \]</span></p>
<p><span class="math inline">\(\phi = \frac{\pi}{6}\)</span></p>
<p>Using bisector method</p>
<p><span class="math inline">\(\gamma = \frac{\pi - \theta - \phi}{2}\)</span></p>
<p><span class="math inline">\(\beta = \pi - \gamma - \theta = 180^{\circ} - 90^{\circ} + \frac{\theta}{2} + \frac{\phi}{2} - \theta = 90^{\circ} - \frac{\theta}{2} + \frac{\phi}{2} - \theta\)</span></p>
<p>Using law of sines</p>
<p><span class="math display">\[\frac{OA}{\sin(\beta)} = \frac{OB}{\sin(\gamma)}\]</span></p>
<p>$OB = $</p></li>
</ol>
</div>
<h1 id="matlab-siso-toolbox">MATLAB SISO Toolbox</h1>
<pre><code>G = tf([4],[1,2,0])
</code></pre>
<p>Open SISO Toolbox</p>
<p>Add design requirements (natural frequency <span class="math inline">\(\omega_n\)</span> and damping coefficient <span class="math inline">\(\zeta\)</span>)</p>
<p>Use bisector method to obtain alpha and add pole/zero pair</p>
<h1 id="bode-plots">Bode Plots</h1>
<p>When a sinusoid is the input to an LTI system:</p>
<p><span class="math inline">\(x(t) = A\sin(\omega t + \theta) \rightarrow y_{ss}(t) = A|G(j\omega t)|sin(\omega t + \theta + \angle G(j\omega))\)</span>)</p>

<div class="derivation" onclick="showHide(this);">
<div>
Proof
</div>
<div class="proof latex" style="display:none;">

<p>Let <span class="math inline">\(G(s) = \frac{1}{s^2 + 3s + 2} = \frac{1}{(s + 1)(s + 2)}\)</span></p>
<p><span class="math inline">\(\frac{Y(s)}{X(s)} = G(s)\)</span></p>
<p><span class="math inline">\(y(t) = y_P(t) + y_H(t) = C_1e^{-2t} + C_2e^{-t} + K_1\sin(\omega t) + K_2\cos(\omega t)\)</span></p>
<p><span class="math inline">\(y_{ss} = \lim_{t \to \infty} y(t) = K_1\sin(\omega t) + K_2\cos(\omega t) = K\sin(\omega t + \theta)\)</span></p>

</div>
</div>

<div class="definition">
<p><strong>Bode plot</strong></p>
<p>Plot of steady state response of a system to sinusoidal input</p>
<p><strong>Magnitude</strong> <span class="math inline">\(M(\omega) = 20 \log |G(j \omega) |\)</span> <span class="math inline">\(|G(jw)| = \sqrt{\text{Re}^2 + \text{Im}^2}\)</span></p>
<p><strong>Phase</strong> <span class="math inline">\(\phi(\omega) = \angle G(j \omega)\)</span> <span class="math inline">\(\angle G(j \omega) = \tan^-1(\frac{\text{Im}}{\text{Re}})\)</span></p>
</div>
<p>From the properties of logarithms, if we know the shapes of the plots from some basic functions, we can compose them by adding them together.</p>
<ol>
<li>Constant</li>
<li>Poles/zeros at origin</li>
<li>Poles/zeros</li>
<li>Complex poles/zeros</li>
</ol>
<h2 id="constant">Constant</h2>
<p>Let <span class="math inline">\(G(s) = K + j0\)</span></p>
<p><span class="math inline">\(|G(jw)| = K\)</span></p>
<p><span class="math inline">\(\angle G(jw) = \tan^{-1} \frac{0}{K} = 0\)</span></p>
<p><strong>No phase contribution</strong></p>
<p><strong>Upward shift of</strong> <span class="math inline">\(20\log(K) \text{ dB}\)</span></p>
<h2 id="zero-at-origin">Zero at origin</h2>
<p>Let <span class="math inline">\(G(s) = j\omega\)</span></p>
<p><span class="math inline">\(|G(j\omega)| = \omega\)</span> <span class="math inline">\(\text{mag. dB} = -20log(\omega)\)</span></p>
<p><span class="math inline">\(\angle G(j\omega) = \tan^{-1} \frac{\omega}{0} = 90^{\circ}\)</span></p>
<p><strong>Upward slope of 20dB/decade for low frequencies</strong></p>
<p><strong>90 degree increase everywhere</strong></p>
<h2 id="pole-at-origin">Pole at origin</h2>
<p>Let <span class="math inline">\(G(s) = \frac{1}{j\omega}\)</span></p>
<p><span class="math inline">\(|G(j\omega)| = \frac{1}{\omega}\)</span> <span class="math inline">\(\text{mag. dB} = -20log(\omega)\)</span></p>
<p><span class="math display">\[\angle G(j\omega) = \frac{1}{\tan^{-1} \left( \frac{\omega}{0} \right)} = -90^{\circ}\]</span></p>
<p><strong>Downward slope of 20dB/decade for low frequencies</strong></p>
<p><strong>90 degree decrease everywhere</strong></p>
<h2 id="zero">Zero</h2>
<p>Let <span class="math inline">\(G(s) = s + \tau\)</span></p>
<p><span class="math inline">\(\tau\)</span> is called breakpoint</p>
<p><span class="math inline">\(|G(jw)| = \sqrt{\omega^2 + \tau^2}\)</span> <span class="math inline">\(\text{mag. dB} = 20\log(\sqrt{\omega^2 + \tau^2})\)</span></p>
<p><span class="math inline">\(\angle G(jw) = \tan^{-1}(\frac{\omega}{\tau})\)</span></p>
<p><strong>Upward slope of 20dB/decade, starting at the break point</strong></p>
<p><strong>+90 degree tangent curve, starting one decade below the breakpoint and ending 1 decade above</strong></p>
<h2 id="pole">Pole</h2>
<p>Let <span class="math inline">\(G(s) = \frac{1}{s + \tau}\)</span></p>
<p><span class="math inline">\(\tau\)</span> is called breakpoint</p>
<p><span class="math display">\[|G(jw)| = \frac{1}{\sqrt{\omega^2 + \tau^2}}\]</span> <span class="math inline">\(\text{mag. dB} = -20\log(\sqrt{\omega^2 + \tau^2})\)</span></p>
<p><span class="math inline">\(\angle G(jw) = -\tan^{-1}(\frac{\omega}{\tau})\)</span></p>
<p><strong>Downward slope of 20dB/decade, starting at the break point</strong></p>
<p><strong>-90 degree tangent curve, starting one decade below the breakpoint and ending 1 decade above</strong></p>
<h2 id="complex">Complex</h2>
<h2 id="construction-by-hand">Construction by Hand</h2>
<p>It is easy to construct fairly accurate bode plots using the primitive elements above.</p>
<p>The plot should range from 1 decade below the lowest breakpoint to 1 decade above the highest.</p>
<div class="examples">
<ol>
<li><p>Let <span class="math inline">\(G(s) = \frac{1}{s + \tau} = \frac{1}{\frac{s}{\tau} + 1}\)</span> (normalized)</p>
<p><span class="math inline">\(|G(j\omega)| = \frac{1}{\sqrt{1 + \frac{\omega}{\tau}^2}}\)</span></p>
<p><span class="math inline">\(\angle G(j\omega) = - \tan^{-1}(\frac{\omega}{\tau})\)</span></p>
<p>Points of interest</p>
<table>
<tbody>
<tr class="odd">
<td></td>
<td><span class="math inline">\(0.1\tau\)</span></td>
<td><span class="math inline">\(\tau\)</span></td>
<td><span class="math inline">\(10\tau\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(-20 \log(G(j\omega))\)</span></td>
<td>0 dB</td>
<td>-3 dB</td>
<td>-20 dB</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\angle G(j\omega)\)</span></td>
<td>0 degrees</td>
<td>-45 degrees</td>
<td>84.3 degrees</td>
</tr>
</tbody>
</table></li>
<li><p>Let <span class="math inline">\(G(s) = \frac{\omega_n^2}{s^2 + 2\zeta \omega_n s + \omega_n^2}\)</span>, where $ 0 &lt; <em>Î¶</em> &lt; 1$ (for a complex system)</p>
<p><span class="math inline">\(G(j \omega) = \frac{1}{1 - v^2 + 2 \zeta j v}\)</span>, where <span class="math inline">\(v = \frac{\omega}{\omega_n}\)</span></p>
<p><span class="math inline">\(|G(j v)| = \frac{1}{\sqrt{1 - v^2 + 4 \zeta^2 v^2}}\)</span></p>
<p><span class="math inline">\(\angle G(j v) = - \tan^{-1}(\frac{2 \zeta v}{1 - v^2})\)</span></p>
<p>Let <span class="math inline">\(\zeta = .1\)</span> Points of interest</p>
<table>
<tbody>
<tr class="odd">
<td><span class="math inline">\(v = \frac{\omega}{\omega_n}\)</span></td>
<td>0.1</td>
<td>1</td>
<td>10</td>
</tr>
<tr class="even">
<td><span class="math inline">\(-20 \log(G(j v))\)</span></td>
<td>0 dB</td>
<td>+14 dB</td>
<td>-40 dB</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\angle G(j\omega)\)</span></td>
<td>0 degrees</td>
<td>-90 degrees</td>
<td>-180 degrees</td>
</tr>
</tbody>
</table></li>
</ol>
</div>
<h1 id="nyquist-plots">Nyquist Plots</h1>
<h2 id="cauchy-theorem">Cauchy Theorem</h2>
<div class="theorem">
<p>Let <span class="math inline">\(F: \mathbb{C} \to \mathbb{C}\)</span> (a transfer function)</p>
<p>Let <span class="math inline">\(\Gamma_s\)</span> be a contour which encircles <span class="math inline">\(Z\)</span> number of zeros and <span class="math inline">\(P\)</span> number of poles of <span class="math inline">\(F\)</span>.</p>
<p>Then the contour <span class="math inline">\(F(\Gamma_s) = \Gamma_F\)</span> encircles the origin <span class="math inline">\(N = Z - P\)</span> times in the clockwise direction.</p>
</div>
<p><a href="./cauchy.png"><img src="./cauchy.png" /></a></p>
<h2 id="nyquist-stability-criterion">Nyquist Stability Criterion</h2>
<p>Let <span class="math inline">\(F(s) = Q(s) = 1 + G(s) = 1 + \frac{N(s)}{D(s)} = \frac{N(s) + D(s)}{D(s)} = \frac{\text{closed-loop poles}}{\text{open-loop poles}}\)</span></p>
<p>So if we let <span class="math inline">\(\Gamma_s\)</span> encircle the RHP plane, we can use the resulting plot to evaluate the stability of the system.</p>
<p>If the system is stable, there are no closed-loop poles in the RHP, so <span class="math inline">\(Z = 0 = N + P\)</span> and <span class="math inline">\(-N = P\)</span>.</p>
<p>This means that the number of times <span class="math inline">\(\Gamma_F\)</span> encircles the origin counter clockwise , <span class="math inline">\(-N\)</span>, must be equal the number of open-loop poles, <span class="math inline">\(P\)</span>, for the system to be stable..</p>
<p><a href="./nyquist_stability.png"><img src="./nyquist_stability.png" /></a></p>
<p>However, we can make a simplification and use <span class="math inline">\(G(\Gamma_s) = \Gamma_G\)</span> instead of <span class="math inline">\(\Gamma_F\)</span>, since it is simpler than <span class="math inline">\(F\)</span>.</p>
<p>Since <span class="math inline">\(F(s) = Q(s) = 1 + G(s)\)</span>, this means that whenever <span class="math inline">\(\Gamma_s\)</span> encircles closed-loop poles or open-loop poles, <span class="math inline">\(\Gamma_G\)</span> will encircle <span class="math inline">\(-1\)</span> instead of the origin.</p>
<p><span class="math inline">\(\Gamma_G\)</span> is called the <strong>Nyquist Plot</strong> for the closed-loop system</p>
<h2 id="construction">Construction</h2>
<p>To get the nyquist plot, we need to construct a contour around the right-half plane, then plug these points into <span class="math inline">\(G(s)\)</span>.</p>
<p>We work in polar coordinates during construction because it matches the geometry of the infinitely large semicircle enclosing the RHP.</p>
<p><span class="math inline">\(re^{j\phi} = \frac{r}{2}(\cos(\phi) + j\sin(\phi))\)</span></p>
<p>A useful property of LTI systems is that <span class="math inline">\(G(s) = |G(s)|\angle G(s)\)</span>, so we will break down <span class="math inline">\(G(s)\)</span> into magnitude and angle before plugging in points.</p>
<div class="examples">
<ol>
<li><p>Let <span class="math inline">\(G(s) = \frac{K}{s + 1}\)</span>. Find the nyquist plot for the negative unity feedback system.</p>
<p>Plotting imaginary axis: <span class="math inline">\(\phi = \pm 90^{\circ}\)</span>, so <span class="math inline">\(s = jw\)</span></p>
<p><span class="math display">\[G(s) = \frac{K}{\sqrt{\omega^2 +1}}\angle -\tan \left( \frac{\omega}{1} \right)\]</span></p>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(\omega\)</span></th>
<th><span class="math inline">\(G(j\omega)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>/</td>
<td>&lt;</td>
</tr>
<tr class="even">
<td><span class="math inline">\(0+\)</span></td>
<td><span class="math inline">\(K \angle - \varepsilon\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\infty\)</span></td>
<td><span class="math inline">\(0 \angle - 90^{\circ}\)</span></td>
</tr>
</tbody>
</table>
<p>Plotting semicircle:</p>
<p><span class="math display">\[\lim_{r \to \infty} G(re^{j\phi}) = \lim_{r \to \infty}\frac{K}{re^{j\phi} + 1} \approx \lim_{r \to \infty}\frac{K}{re^{j\phi}} = 0*e^{-j\phi} = 0*(\cos(-\phi) + j\sin(-\phi)) = |0|\angle \tan^{-1}\left( \frac{\sin(-\phi)}{\cos(-\phi)} \right) = |0|\angle \phi\]</span></p>
<table>
<thead>
<tr class="header">
<th>$<em>Ï•</em></th>
<th><span class="math inline">\(\lim_{r \to \infty}G(re^{j\phi})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>/</td>
<td>&lt;</td>
</tr>
<tr class="even">
<td><span class="math inline">\(90^{\circ}\)</span></td>
<td><span class="math inline">\(\vert 0 \vert \angle -90^{\circ}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(0^{\circ}\)</span></td>
<td><span class="math inline">\(\vert 0 \vert \angle 0^{\circ}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(-90^{\circ}\)</span></td>
<td><span class="math inline">\(\vert 0 \vert \angle 90^{\circ}\)</span></td>
</tr>
</tbody>
</table>
<p><a href="./nyquist_ex1.png"><img src="./nyquist_ex1.png" /></a></p>
<p>Does not encircle -1, so N = 0.</p>
<p>-N = P, so system is stable.</p></li>
<li><p>Let <span class="math inline">\(G(s) = \frac{K}{s(s+1)}\)</span></p>
<p><span class="math display">\[G(s) = \frac{K}{j\omega(\omega+1)} = |\frac{K}{\omega^2 \sqrt{\omega^2 + 1}}| \angle - (90^{\circ} + \tan^{-1}\left( \frac{\omega}{1} \right))\]</span></p>
<p>Plotting imaginary axis: <span class="math inline">\(\phi = \pm 90^{\circ}\)</span>, so <span class="math inline">\(s = jw\)</span></p>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(\omega\)</span></th>
<th><span class="math inline">\(G(j\omega)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>/</td>
<td>&lt;</td>
</tr>
<tr class="even">
<td><span class="math inline">\(0+\)</span></td>
<td><span class="math inline">\(\vert \infty \vert \angle - (90^{\circ} + \varepsilon)\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\infty\)</span></td>
<td><span class="math inline">\(0 \angle 180^{\circ} - \varepsilon\)</span></td>
</tr>
</tbody>
</table>
<p>Plotting large semicircle</p>
<p><span class="math display">\[\lim_{r \to \infty} G(re^{j\phi}) = \lim_{r \to \infty}\frac{K}{r^2e^{2j\phi} + re^{j\phi}} \approx \lim_{r \to \infty}\frac{K}{r^2e^{2j\phi}} = |0|\angle e^{-2j\phi}\]</span></p>
<table>
<thead>
<tr class="header">
<th>$<em>Ï•</em></th>
<th><span class="math inline">\(\lim_{r \to \infty}G(re^{j\phi})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>/</td>
<td>&lt;</td>
</tr>
<tr class="even">
<td><span class="math inline">\(90^{\circ}\)</span></td>
<td><span class="math inline">\(\vert 0 \vert \angle -180^{\circ}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(0^{\circ}\)</span></td>
<td><span class="math inline">\(\vert 0 \vert \angle 0^{\circ}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(-90^{\circ}\)</span></td>
<td><span class="math inline">\(\vert 0 \vert \angle 180^{\circ}\)</span></td>
</tr>
</tbody>
</table>
<p>Plotting small semicircle</p>
<p><span class="math display">\[\lim_{r \to 0} G(re^{j\phi}) = \lim_{r \to 0}\frac{K}{r^2e^{2j\phi} + re^{j\phi}} \approx \lim_{r \to 0}\frac{K}{re^{j\phi}} = |\infty|\angle e^{-j\phi}\]</span></p>
<table>
<thead>
<tr class="header">
<th>$<em>Ï•</em></th>
<th><span class="math inline">\(\lim_{r \to \infty}G(re^{j\phi})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>/</td>
<td>&lt;</td>
</tr>
<tr class="even">
<td><span class="math inline">\(90^{\circ}\)</span></td>
<td><span class="math inline">\(\vert \infty \vert \angle -90^{\circ}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(0^{\circ}\)</span></td>
<td><span class="math inline">\(\vert \infty \vert \angle 0^{\circ}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(-90^{\circ}\)</span></td>
<td><span class="math inline">\(\vert \infty \vert \angle 90^{\circ}\)</span></td>
</tr>
</tbody>
</table>
<p><a href="./nyquist_ex2.png"><img src="./nyquist_ex2.png" /></a></p>
<p>Does not encircle -1, so <span class="math inline">\(N = 0\)</span>.</p>
<p><span class="math inline">\(-N = P\)</span>, so system is stable.</p></li>
<li><p>Let <span class="math inline">\(G(s) = \frac{K}{s^2(s+1)}\)</span></p>
<p>For the real axis <span class="math inline">\(G(s) = \frac{K}{s^2(s + 1)\)</span></p>
<p>For the semicircles <span class="math inline">\(G(s) \approx \frac{K}{s^3\)</span></p>
<table>
<thead>
<tr class="header">
<th>s</th>
<th>G(s)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>/</td>
<td>&lt;</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\varepsilon j\)</span></td>
<td><span class="math inline">\(\vert \infty \vert \angle - 180^{\circ} - \varepsilon\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\infty j\)</span></td>
<td><span class="math inline">\(\vert 0 \vert \angle - 270^{\circ}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\infty e^{\frac{\pi}{2} j}\)</span></td>
<td><span class="math inline">\(\vert 0 \vert \angle - 270^{\circ}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\infty e^{0 j}\)</span></td>
<td><span class="math inline">\(\vert 0 \vert \angle 0^{\circ}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\infty e^{\frac{-\pi}{2} j}\)</span></td>
<td><span class="math inline">\(\vert 0 \vert \angle 270^{\circ}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(-\infty j\)</span></td>
<td><span class="math inline">\(\vert 0 \vert \angle 270^{\circ}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(- \varepsilon j\)</span></td>
<td><span class="math inline">\(\vert \infty \vert \angle 180^{\circ} - \varepsilon\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\varepsilon e^{- 90^{\circ} j}\)</span></td>
<td><span class="math inline">\(\vert \infty \vert \angle 270^{\circ}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\varepsilon e^{0^{\circ} j}\)</span></td>
<td><span class="math inline">\(\vert \infty \vert \angle 0^{\circ}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\varepsilon e^{90^{\circ} j}\)</span></td>
<td><span class="math inline">\(\vert \infty \vert \angle - 270^{\circ}\)</span></td>
</tr>
</tbody>
</table>
<p><a href="./nyquist_ex3.png"><img src="./nyquist_ex3.png" /></a></p>
<p>Encircles -1 twice, so <span class="math inline">\(N = 2\)</span>.</p>
<p><span class="math inline">\(-N \neq P\)</span>, so system is unstable.</p></li>
</ol>
</div>
<h2 id="gain-and-phase-margins">Gain and Phase Margins</h2>
<p>The gain margin <span class="math inline">\(G_m\)</span> and phase margin <span class="math inline">\(\phi_{PM}\)</span> are useful for determining when instability occurs as gain or phase are changed.</p>
<p><a href="./crossover.png"><img src="./crossover.png" /></a></p>
<p>Note that the magnitude and phase of the nyquist plot as a function of frequency are identical to the bode plot.</p>
<p>Let <span class="math inline">\(\omega_pi\)</span> be the frequency when the bode plot crosses the real axis. When <span class="math inline">\(|G(\omega_{\pi})| &gt; 1\)</span> the nyquist plot encloses -1 and the system becomes unstable, so for the system to remain stable <span class="math inline">\(|G(\omega_{\pi})| &lt; 1\)</span> and <span class="math inline">\(G_M &gt; 1\)</span></p>
<p>We define gain margin as a method for quantifying this property.</p>
<div class="definition">
<p><span class="math inline">\(G_m = \frac{1}{|G(j\omega_{\pi})|}\)</span></p>
<p>where <span class="math inline">\(\omega_{\pi}\)</span> is the phase crossover frequency, (the frequency where the nyquist plot intersects the real axis)</p>
</div>
<p>Physically, the gain margin is the gain that can be added to the system before it becomes unstable. To solve for <span class="math inline">\(\omega_{\pi}\)</span>, use the fact that the imaginary part of <span class="math inline">\(|G(\j omega_\pi)|\)</span> is zero.</p>
<p>Let <span class="math inline">\(\omega_c\)</span> be the frequency where the nyquist plot crosses the unit circle. If the angle at this point (shown above as <span class="math inline">\(\alpha\)</span> is less than 0, the nyquist plot encloses -1, and the system becomes unstable.</p>
<p>The phase margin quantifies this property.</p>
<div class="definition">
<p><span class="math inline">\(\phi_{PM} = 180^{\circ} + \angle G(j\omega_c)\)</span></p>
<p>where <span class="math inline">\(\omega_c\)</span> is the gain crossover frequency, (the frequency where the nyquist plot intersects the unit circle).</p>
</div>
<div class="examples">
<ol>
<li><p>Let <span class="math inline">\(G(s) = \frac{K}{s(s+1)(s+2)}\)</span></p>
<p><span class="math inline">\(G(jw) = \frac{K}{j\omega(j\omega+1)(j\omega+2)} * \frac{j\omega(j\omega-1)(j\omega-2)}{j\omega(j\omega-1)(j\omega-2)}= \frac{Kj\omega(j\omega - 1)(j\omega-2)}{\text{don&#39;t care}}\)</span></p>
<p>To find phase crossover and gain margin:</p>
<p><span class="math inline">\(\text{Im}(G(j\omega_\pi)) = \text{Im}\left(\frac{Kj\omega_\pi(j\omega_\pi - 1)(j\omega_\pi-2)}{\text{don&#39;t care}}\right) =  \frac{k\omega_\pi(2 - \omega_\pi^2)}{\text{don&#39;t care}} = 0 \longrightarrow \omega_\pi^2 = 2 \longrightarrow \omega_\pi = \sqrt{2}\)</span></p>
<p><span class="math inline">\(|G(j\omega_\pi)| = \frac{K}{\omega_\pi^2(\omega_\pi^2 + 1)(\omega_\pi^2 + 2)} = \frac{K}{6}\)</span></p>
<p><span class="math inline">\(|G(j\omega_\pi)| &lt; 1 \longrightarrow K &lt; 6\)</span></p>
<p>To find phase margin:</p>
<p><span class="math inline">\(|G(j\omega_c)| = 1 \longrightarrow \frac{K}{\omega_c \sqrt{\omega_c^2 + 1} \sqrt{\omega_c^2 + 4}} = 1 \longrightarrow \omega_c^6 + 5\omega_c^4 + 4\omega_c^2 - K^2 = 0\)</span></p></li>
</ol>
</div>
<h1 id="lead-compensator-design-in-frequency-domain">Lead Compensator Design in Frequency Domain</h1>
<p>In a lead compensator, we try to adjust the phase margin of <span class="math inline">\(G(s)\)</span> by adding the phase from the compensator to the phase of <span class="math inline">\(G(s)\)</span>.</p>
<p>We set the compensator phase peak frequency to the crossover frequency of <span class="math inline">\(G_c(s)G(s)\)</span></p>
<p><a href="./nyquist_lead_bode.png"><img src="./nyquist_lead_bode.png" /></a></p>
<p>Let <span class="math inline">\(G_c = \frac{K_c ( s + \frac{1}{\tau})}{s + \frac{1}{\alpha \tau}} = \left|\frac{K_c  \sqrt{\omega^2 + (\frac{1}{\tau})^2}}{\sqrt{\omega^2 + (\frac{1}{\alpha \tau})^2}} \right| \angle \tan^{-1}(\omega \tau) - \tan^{-1}(\omega \alpha \tau)\)</span></p>
<p>We can use the angle to be added by the compensator (<span class="math inline">\(\phi_m\)</span>, angle of deficiency) to find <span class="math inline">\(\alpha\)</span> the ratio of the zero to pole location.</p>
<p><span class="math inline">\(\sin(\phi_m) = \frac{1 - \alpha}{1 + \alpha} \longrightarrow \alpha = \frac{1 - \sin(\phi_m + \varepsilon)}{1 + \sin(\phi_m + \varepsilon)}\)</span></p>
<p>We add <span class="math inline">\(\varepsilon\)</span> to account for a slight phase shift that we will see later.</p>
<p>with frequency <span class="math inline">\(\omega_m = \frac{1}{\sqrt{\alpha} \tau}\)</span> with the pole and zero separated like this, there is also going to be an addition to the magnitude.</p>
<p>The phase peak is located halfway between the pole and zero on a logarithmic plot, so the magnitude contribution is <span class="math inline">\(\frac{20\log(\alpha)}{2} = 10\log(\alpha)\)</span></p>
<p>Next, we find the frequency on <span class="math inline">\(|G(j\omega)|\)</span> where the magnitude is equal to <span class="math inline">\(10\log(\alpha)\)</span>. When the compensator is added, this will be where <span class="math inline">\(|G(j\omega)G_c(j\omega)|\)</span> intersects <span class="math inline">\(0 \text{ dB}\)</span>. We call this frequency <span class="math inline">\(\omega_c^*\)</span>.</p>

<div class="derivation" onclick="showHide(this);">
<div>
Derivation
</div>
<div class="derivation latex" style="display:none;">

<p><span class="math inline">\(|G_d(j\omega_m)| = |G_c(j\omega_m)G(j\omega_m)| = 0 \text{ dB}\)</span></p>
<p><span class="math display">\[ \begin{aligned}
20 \log |G(j\omega_m)| &amp; = -20 \log |G_c(j \omega_m)| \\
&amp; = -20 \log \left[ \frac{\frac{1}{\alpha} \sqrt{\omega_m^2 + (\frac{1}{\tau})^2}}{\sqrt{\omega_m^2 + (\frac{1}{\alpha \tau})^2}} \right] \\
&amp; = -20 \log \left[ \frac{\frac{1}{\alpha} \frac{1}{\tau} \sqrt{\frac{1}{\alpha} + 1}}{\frac{1}{\sqrt{\alpha}}\frac{1}{\tau} \sqrt{\frac{1}{\alpha} + 1}} \right] = 10 \log \alpha
\end{aligned} \]</span></p>

</div>
</div>

<p>Now that we know where to place the peak of the phase of the compensator, we can calculate the frequencies of the zero and pole.</p>

<div class="derivation" onclick="showHide(this);">
<div>
Derivation
</div>
<div class="derivation latex" style="display:none;">

<p>The peak is located at the geometric mean of the peak and pole, so</p>
<p><span class="math inline">\(\omega_{mean} = \sqrt{\frac{1}{\tau} \frac{1}{\alpha \tau}} = \frac{1}{\sqrt{\alpha} \tau}\)</span></p>
<p><span class="math inline">\(\omega_c^* = \frac{1}{\sqrt{\alpha}\tau} \longrightarrow \frac{1}{\tau} = \sqrt{\alpha} \omega_c^*\)</span></p>

</div>
</div>

<p>Finally, since <span class="math inline">\(\omega_c^* &gt; \omega_c\)</span>, the phase margin at <span class="math inline">\(G(j\omega_c^*\)</span> is slightly less than <span class="math inline">\(G(j\omega_c\)</span>. We check that this drop in phase is less than <span class="math inline">\(\varepsilon\)</span></p>
<h2 id="design-summary">Design Summary</h2>
<ol>
<li>Determine the gain of <span class="math inline">\(G\)</span> from initial conditions.</li>
<li>Find the phase margin of <span class="math inline">\(G\)</span>. Use this (plus <span class="math inline">\(\varepsilon\)</span> of <span class="math inline">\(5-12^{\circ}\)</span>) to determine pole/zero ratio, <span class="math inline">\(\alpha\)</span></li>
<li>Find the frequency where <span class="math inline">\(|G(j\omega)| = 10\log(\alpha)\)</span>. This is <span class="math inline">\(\omega_c^*\)</span></li>
<li>Calculate pole zero locations. zero: <span class="math inline">\(\frac{1}{\tau} = \sqrt{\alpha} \omega_c^*\)</span>, pole: <span class="math inline">\(\frac{\text{zero}}{\alpha}\)</span></li>
<li>Verify that <span class="math inline">\(\angle G(j\omega_c) - \angle G(j\omega_c^*) &lt; \varepsilon\)</span></li>
</ol>
<div class="examples">
<ol>
<li><p>Let <span class="math inline">\(G(s) = \frac{K}{s(s+2)}\)</span>. Assume design requirements are</p>
<p><span class="math inline">\(K_v = 20 \text{ s}^{-1}\)</span>, <span class="math inline">\(\phi_{PMd} \geq 50^{\circ}\)</span>, <span class="math inline">\(G_md \geq 10 \text{ dB}\)</span></p>
<p>First find the gain of <span class="math inline">\(G(s)\)</span> to satisfy the position error constant, <span class="math inline">\(K_v\)</span></p>
<p><span class="math inline">\(K_v = \lim_{s \to 0}sG(s) = \frac{K}{2} = 20 \longrightarrow K = 40\)</span></p>
<pre><code>pkg load control
s = tf([40],[1 2 0]);
[mag ph w] = bode(s);
[mag2db(mag) ph w&#39;]
</code></pre>
<p><a href="./nyquist_lead.png"><img src="./nyquist_lead.png" /></a></p>
<p>Using the bode plot, we can find <span class="math inline">\(\omega_c = 6.17 \text{ rad/s}\)</span> and <span class="math inline">\(\omega_\pi = \infty\)</span></p>
<p><span class="math inline">\(\phi_{PM} = 180^{\circ} + \angle G(j \omega_c) \approx 17.964^{\circ}\)</span></p>
<p><span class="math display">\[G_m = \frac{1}{|G(j\omega_\pi)|} = \infty \text{ dB}\]</span></p>
<p><span class="math inline">\(\phi_{PMd} = 50^{\circ} = \phi_{PM} + \phi_m\)</span></p>
<p>So the phase angle that needs to be added is:</p>
<p><span class="math inline">\(\phi_m = 50 - \phi_{PM} = 32.036^{\circ}\)</span></p>
<p>If we let <span class="math inline">\(\varepsilon = 5^{\circ}\)</span>, then <span class="math inline">\(\phi_m = 32.036^{\circ} + 5^{\circ} = 37.036^{\circ}\)</span>.</p>
<p>So <span class="math inline">\(\alpha = \frac{1 - \sin(37.036^{\circ})}{1 + \sin(37.036^{\circ})} =  0.248\)</span></p>
<p><span class="math inline">\(10\log(\alpha) = -6.04 \text{ dB}\)</span></p>
<p>Checking the bode plot again, we find that <span class="math inline">\(|G(j\omega)| = 10\log(\alpha)\)</span> at <span class="math inline">\(8.87 \text{ rad/s}\)</span>.</p>
<p>The phase angle at this point is <span class="math inline">\(-167.3^{\circ}\)</span>, which is a decrease of <span class="math inline">\(5.336^{\circ}\)</span>.</p>
<p>Since <span class="math inline">\(5.336 &gt; \varepsilon\)</span>, we must use <span class="math inline">\(\varepsilon = 6^{\circ}\)</span> and repeat the process:</p>
<p><span class="math inline">\(\alpha = 0.2375\)</span></p>
<p><span class="math inline">\(10\log(\alpha) = -6.2433 \text{ dB}\)</span></p>
<p>This yields a decrease in <span class="math inline">\(5.353^{\circ} &gt; \varepsilon\)</span> at <span class="math inline">\(8.993 \text{ rad/s}\)</span></p>
<p>so <span class="math inline">\(\omega_c^* = 8.993\)</span></p>
<p>zero: <span class="math inline">\(\frac{1}{\tau} = \sqrt{\alpha}\omega_c^* = 4.383\)</span> pole: <span class="math inline">\(\frac{1}{\alpha\tau} = 18.453\)</span></p>
<p><span class="math inline">\(G_c(s) = \frac{\frac{1}{0.2375}(s + 4.383)}{s + 18.453}\)</span></p>
<p><a href="./nyquist_lead2.png"><img src="./nyquist_lead2.png" /></a></p></li>
</ol>
</div>
				</div>
			</div>
		</div>
	</div>
</body>
</html>
